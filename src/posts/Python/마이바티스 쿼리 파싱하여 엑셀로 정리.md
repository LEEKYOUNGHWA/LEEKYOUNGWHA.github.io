# mybatis parse

'''
#anaconda prompt> pip install xmltodict
import xmltodict
import json
from openpyxl import Workbook
from pathlib import Path
from openpyxl import load_workbook
wb = load_workbook(filename = 'smtcServer쿼리조사.xlsx')
smtc = wb['smtc webdb 커넥션  조사']
# newwb = Workbook()  
# # newwb = load_workbook(filename = 'smtcServer쿼리조사.xlsx')
# ws1 = newwb.active
# # ws1 = newwb['persist-impl']
# ws1.append(['번호','ecdDataSource','impl'])

i=1
for row in smtc.iter_rows(min_col=2, min_row=53 ,max_col=2 ,max_row=83):
    for cell in row:
        print(cell.value, end=" ")
        my_file = Path('C:\\workspace\\smart4c_mip_all\\resource\\spring\\persists\\'+cell.value)
        if my_file.is_file() == False:
            continue
        with open('C:\\workspace\\smart4c_mip_all\\resource\\spring\\persists\\'+cell.value, 'r',encoding='utf-8') as f:
            data = f.read()
        doc = xmltodict.parse(data)
        doc = doc['beans']['bean']
#         print(json.dumps(doc, indent=4))
        if len(doc)==2 :
            for bean in doc:
                if '.incrementer.' not in bean['@class']:
#                     print(cell.value, ' ', bean['@class'])
                    classid = bean['@class']
                    print(i, cell.value, classid.split('.')[-1]+'.java')
                    smtc['C'+str(i)] = classid.split('.')[-1]+'.java'
#                     ws1.append([i,cell.value,classid.split('.')[-1]+'.java'])
        else :
#             print(cell.value, ' ',doc['@class'])
            classid = doc['@class']
            print(i, cell.value, classid.split('.')[-1]+'.java')
            smtc['C'+str(i)] = classid.split('.')[-1]+'.java'
#             ws1.append([i,cell.value,classid.split('.')[-1]+'.java'])
        i = i+1
#             if 'impl' in bean['@class']:
#                     print(bean['@class'])
#         print(doc)
#         doc = doc['@class'].split('.')[-1]+'.java'
#         print(doc)
#         print(json.dumps(doc, indent=4))

# newwb.save('smtcServer쿼리조사.xlsx')
# newwb.save('smtcServer쿼리조사.xlsx')
# print(smtc['a1'].value)
# smtc['a1'].value = 'ttttttttttttttttttttt\ntttttttt\nttttttt\nttt'

wb.save('smtcServer쿼리조사.xlsx')

# sheet['A1'] = 1
# sheet.cell(row=2, column=2).value = 2

# book.save('write2cell.xlsx')
'''
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTM3NTY2NzUwXX0=
-->